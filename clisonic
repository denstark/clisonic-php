#!/usr/bin/php
<?php

require_once('initialize.php');

// Get Current PID and put in shared mem (For the helper program)
$mainpid = getmypid();
csMemory::set(SHM_PID_KEY, $mainpid);

// Set the queue to null in case anything is still around from last run.
csQueue::set(array());
csPlayer::setTimeLeft(0);
csPlayer::resetPause();

// Launch helper program.
exec('./helper > /tmp/helperout 2>&1 &');
csPlayer::setFifo($mplayerfifo);

while (true) 
{
  csController::go($stdio);
}